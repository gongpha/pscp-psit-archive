This is my solution, some problem might be missing or swap.